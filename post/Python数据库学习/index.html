<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>Pythonæ•°æ®åº“å­¦ä¹  | Tudouvvv</title>
<meta name="description" content="äººç”Ÿè¿˜é•¿ï¼Œæ…¢æ…¢æ¥">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://tudouvvv.github.io//favicon.ico?v=1563366891084">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://tudouvvv.github.io//styles/main.css">



<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>

<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />



  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://tudouvvv.github.io/">
        <img src="https://tudouvvv.github.io//images/avatar.png?v=1563366891084" class="site-logo">
        <h1 class="site-title">Tudouvvv</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            é¦–é¡µ
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            å½’æ¡£
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            æ ‡ç­¾
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            å…³äº
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
          <a class="social-link" href="https://github.com/tudouvvv" target="_blank">
            <i class="fab fa-github"></i>
          </a>
        
      
        
          <a class="social-link" href="https://www.instagram.com/gu_lo__/" target="_blank">
            <i class="fab fa-twitter"></i>
          </a>
        
      
        
          <a class="social-link" href="https://weibo.com/u/303731603" target="_blank">
            <i class="fab fa-weibo"></i>
          </a>
        
      
        
      
        
      
    </div>
    <div class="site-description">
      äººç”Ÿè¿˜é•¿ï¼Œæ…¢æ…¢æ¥
    </div>
    <div class="site-footer">
      Powered by <a href="https://github.com/tudouvvv" target="_blank">Tudouvvv</a> | <a class="rss" href="https://tudouvvv.github.io//atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">Pythonæ•°æ®åº“å­¦ä¹ </h2>
            <div class="post-date">2018-09-26</div>
            
              <div class="feature-container" style="background-image: url('https://raw.githubusercontent.com/Tudouvvv/Pic_path/master/2018-09-26-%E6%95%B0%E6%8D%AE%E5%BA%93.png')">
              </div>
            
            <div class="post-content">
              <center>ç¨‹åºå‘˜è¿›é˜¶ä¹‹é“ğŸ‘†</center>
<!--more-->
å‡†å¤‡å­¦ä¹ ä¸€äº› è¿›é˜¶çš„çŸ¥è¯†ï¼Œåˆšå¥½çœ‹åˆ°è¿™ä¸ªè¯¾ç¨‹ï¼Œå¼€ä¸€ç¯‡è®°å½•ä¸€ä¸‹å­¦ä¹ ç¬”è®°ï¼  
<p>æ•°æ®åº“ï¼Œå³å­˜å‚¨æ•°æ®çš„ä»“åº“ï¼Œç°åœ¨ä¸€èˆ¬åˆ†ä¸ºå…³ç³»å‹æ•°æ®åº“å’Œéå…³ç³»å‹æ•°æ®åº“ã€‚</p>
<h1 id="centermysqlcenter"><center>MySQL</center></h1>
<h1 id="1-åœ¨ç»ˆç«¯ä½¿ç”¨">1ã€åœ¨ç»ˆç«¯ä½¿ç”¨</h1>
<p>é¦–å…ˆå­¦ä¹ äº†ä¸€äº›mysqlçš„å‘½ä»¤ï¼š</p>
<ul>
<li>åœ¨ç»ˆç«¯ä¸­ç™»å½•MySQLï¼š<code>mysql -u root -p</code></li>
<li><code>mysql -V</code>  :è¾“å‡ºç‰ˆæœ¬ä¿¡æ¯å¹¶ä¸”é€€å‡º</li>
<li><code>mysql -u</code>  :ç”¨æˆ·å</li>
<li><code>mysql -p</code> :å¯†ç   å›è½¦åå¯ä»¥éšè—ç™»å½•</li>
<li><code>mysql -P</code> :ç«¯å£å·   é»˜è®¤3306ï¼Œå¯ä¸åŠ </li>
<li><code>mysql -h</code> :æœåŠ¡å™¨åç§°  æœ¬åœ°ä½¿ç”¨ï¼Œé»˜è®¤127.0.0.1</li>
<li>é€€å‡º  :<code>exitï¼›quitï¼›\qï¼›</code></li>
<li>ä¿®æ”¹æç¤ºç¬¦(æš‚æ—¶è¿˜ä¸çŸ¥é“æœ‰ä»€ä¹ˆç”¨)ï¼š<code>prompt xxx</code><br>
å¸¸ç”¨æç¤ºç¬¦ï¼š<code>\D--&gt;å®Œæ•´çš„æ—¥æœŸ \d--&gt;å½“å‰æ•°æ®åº“ \h--&gt;æœåŠ¡å™¨åç§° \u--&gt;å½“å‰ç”¨æˆ·</code></li>
</ul>
<p>MySQLè¯­å¥çš„è§„èŒƒï¼š</p>
<ul>
<li>å…³é”®å­—ä¸å‡½æ•°åç§°å…¨éƒ¨å¤§å†™</li>
<li>æ•°æ®åº“åç§°ã€è¡¨åç§°ã€å­—æ®µåç§°å…¨éƒ¨å°å†™</li>
<li>SQLè¯­å¥å¿…é¡»ä»¥åˆ†å·ç»“å°¾</li>
</ul>
<p>å…¶å®ƒå‘½ä»¤ï¼š</p>
<ul>
<li>æ˜¾ç¤ºå½“å‰æœåŠ¡å™¨ç‰ˆæœ¬:<code>SELECT VERSION();</code></li>
<li>æ˜¾ç¤ºå½“å‰æ—¥æœŸæ—¶é—´:<code>SELECT NOW();</code></li>
<li>æ˜¾ç¤ºå½“å‰ç”¨æˆ·:<code>SELECT USER();</code></li>
<li>æ˜¾ç¤ºå½“å‰æ•°æ®åº“:<code>SELECT DATABASE() ;</code></li>
</ul>
<p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p>
<h1 id="2-æ“ä½œæ•°æ®åº“">2ã€æ“ä½œæ•°æ®åº“</h1>
<p>(Ps.<code>{}å¿…é¡»è¾“å…¥ [] é€‰æ‹©è¾“å…¥</code>)</p>
<h2 id="1-åˆ›å»ºæ•°æ®åº“">1ã€åˆ›å»ºæ•°æ®åº“:</h2>
<pre><code>CREATE {DATABASE | SCHEME}  [IF NOT EXISTS] db_name;
</code></pre>
<h2 id="2-è®¾ç½®ç¼–ç æ–¹å¼">2ã€è®¾ç½®ç¼–ç æ–¹å¼:</h2>
<pre><code>[DEFAULT] CHARACTER SET [=] charset_name;
</code></pre>
<h2 id="3-æŸ¥çœ‹warings">3ã€æŸ¥çœ‹Warings:</h2>
<pre><code>SHOW WARINIGS;
</code></pre>
<h2 id="4-æŸ¥çœ‹åˆ›å»ºæ•°æ®åº“æ—¶çš„ç¼–ç æ–¹å¼">4ã€æŸ¥çœ‹åˆ›å»ºæ•°æ®åº“æ—¶çš„ç¼–ç æ–¹å¼:</h2>
<pre><code>SHOW CREATE DATABASE db_name;
</code></pre>
<h2 id="5-æŸ¥çœ‹å½“å‰æœåŠ¡å™¨ä¸‹çš„æ•°æ®åº“åˆ—è¡¨">5ã€æŸ¥çœ‹å½“å‰æœåŠ¡å™¨ä¸‹çš„æ•°æ®åº“åˆ—è¡¨:</h2>
<pre><code>SHOW {DATABASES | SCHEMES};
</code></pre>
<h2 id="6-ä¿®æ”¹æ•°æ®åº“">6ã€ä¿®æ”¹æ•°æ®åº“:</h2>
<pre><code>ALTER {DATABASE | SCHEME} [db_name]  
[DEFAULT] CHARACTER SET [=] charset_nameï¼›
</code></pre>
<h2 id="7-åˆ é™¤æ•°æ®åº“">7ã€åˆ é™¤æ•°æ®åº“:</h2>
<pre><code>DROP {DATABASE | SCHEME} [IF EXISTS] db_name;
</code></pre>
<p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p>
<h1 id="3-æ•°æ®ç±»å‹">3ã€æ•°æ®ç±»å‹</h1>
<ul>
<li>æ•°æ®ç±»å‹æ˜¯æŒ‡åˆ—ã€å­˜å‚¨è¿‡ç¨‹å‚æ•°ã€è¡¨è¾¾å¼å’Œå±€éƒ¨å˜é‡çš„æ•°æ®ç‰¹å¾ï¼Œå®ƒå†³å®šäº†æ•°æ®çš„å­˜å‚¨æ ¼å¼ï¼Œä»£è¡¨äº†ä¸åŒçš„ä¿¡æ¯ç±»å‹ã€‚</li>
<li>MySQLä¸­å®šä¹‰æ•°æ®å­—æ®µçš„ç±»å‹å¯¹æ•°æ®åº“çš„ä¼˜åŒ–æ˜¯éå¸¸é‡è¦çš„ã€‚</li>
<li>MySQLæ”¯æŒå¤šç§ç±»å‹ï¼Œå¤§è‡´å¯ä»¥åˆ†ä¸ºä¸‰ç±»ï¼šæ•°å€¼ã€æ—¥æœŸ/æ—¶é—´å’Œå­—ç¬¦ä¸²(å­—ç¬¦)ç±»å‹ã€‚</li>
</ul>
<p><img src="https://raw.githubusercontent.com/Tudouvvv/Pic_path/master/2018-09-26-%E7%B1%BB%E5%9E%8B.png" alt=""><br>
<code>UNSIGNED</code>è¡¨ç¤ºæ— ç¬¦å·ï¼Œä¸€èˆ¬æ”¾åœ¨æ•°æ®ç±»å‹çš„åé¢<br>
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p>
<h1 id="4-æ•°æ®è¡¨">4ã€æ•°æ®è¡¨</h1>
<p>æ•°æ®è¡¨æ˜¯æ•°æ®åº“çš„æœ€é‡è¦çš„ç»„æˆéƒ¨åˆ†ä¹‹ä¸€ï¼Œæ˜¯å…¶å®ƒå¯¹è±¡çš„åŸºç¡€ã€‚</p>
<h2 id="1-ä½¿ç”¨æ•°æ®åº“">1ã€ä½¿ç”¨æ•°æ®åº“:</h2>
<pre><code>USE db_name;
</code></pre>
<h2 id="2-åˆ›å»ºæ•°æ®è¡¨">2ã€åˆ›å»ºæ•°æ®è¡¨:</h2>
<pre><code>CREATE TABLE [IF NOT EXISTS] table_name(
Column_name(åˆ—åç§°ï¼‰ data_type(æ•°æ®ç±»å‹) .... ,
...
);
</code></pre>
<center>å®ä¾‹ï¼šğŸ‘‡</center>
<center>![](https://raw.githubusercontent.com/Tudouvvv/Pic_path/master/2018-09-26-%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E8%A1%A8.png)</center>
## 3ã€æŸ¥è¯¢æ•°æ®è¡¨åˆ—è¡¨:
```
SHOW TABLES [FROM db_name]
[LIKE 'pattern' | WHERE expr]
```
## 4ã€æŸ¥çœ‹æ•°æ®è¡¨ç»“æ„:
```
SHOW COLUMNS FROM tb_name;
```
## 5ã€æ•°æ®æ’å…¥:
```
INSERT [INTO] tbl_name [( col_name,â€¦)] VALUES(VAL,â€¦);
```
## 6ã€ä¿®æ”¹æ•°æ®:
```
UPDATE table_references
SET col_name = expr1[, col_name2 = expr2â€¦]
[WHERE where_definition];   --->å¾ˆé‡è¦
```
## 7ã€åˆ é™¤æ•°æ®:
```
DELETE FROM tbl_name
[WHERE where_defination];
```
<p>ä¸Šé¢éƒ½æ˜¯MySQLæœ€åŸºç¡€çš„ä¸€äº›çŸ¥è¯†ï¼Œå†å¾€åçš„ä¼šæ…¢æ…¢å­¦ä¹ ã€‚<br>
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p>
<h1 id="5-ç”¨pythonè¿æ¥mysqlæ•°æ®åº“">5ã€ç”¨pythonè¿æ¥mysqlæ•°æ®åº“</h1>
<h2 id="1-mysqldbå­¦ä¹ ">1ã€MySQLdbå­¦ä¹ </h2>
<p>ä¸‹è½½äº†MysqlDbè¿™ä¸ªåŒ…ï¼Œå› ä¸ºä¹‹å‰åˆ›å»ºäº†ä¸€ä¸ªæ•°æ®åº“å¹¶ä¸”æ·»åŠ äº†ä¸€äº›æ•°æ®ï¼š<br>
<img src="https://raw.githubusercontent.com/Tudouvvv/Pic_path/master/2018-09-26-news.png" alt=""><br>
æ‰€ä»¥ä¼šå°è¯•è¿æ¥è¿™ä¸ªæ•°æ®åº“å¹¶å¯¹è¿™ä¸ªæ•°æ®è¡¨åšä¸€äº›æ“ä½œï¼ï¼ï¼å¼€å§‹ç”¨ä¸€ä¸ªæ–°åŒ…çš„è¯ï¼Œå®˜æ–¹æ–‡æ¡£æœ‰å¾ˆè¯¦ç»†çš„è®²è§£ ã€‚</p>
<p>MySQLdbæä¾›äº†<code>connect</code>æ–¹æ³•æ¥å»ºç«‹ä¸€ä¸ªä¸æ•°æ®åº“çš„è¿æ¥ï¼Œè°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„<code>close</code>æ–¹æ³•æ¥å…³é—­ä¸€ä¸ªè¿æ¥ã€‚é€šè¿‡è¿™ä¸ªè¿æ¥å¯ä»¥åˆ›å»ºå‡ºä¸€ä¸ªæ¸¸æ ‡å¯¹è±¡<code>cursor</code>ï¼Œé€šè¿‡æ¸¸æ ‡å¯¹è±¡æ‰§è¡ŒSQLè¯­å¥æ¥è¿›è¡Œæ•°æ®çš„å¢åˆ æŸ¥æ”¹ã€‚</p>
<pre><code class="language-python">import MySQLdb
try:
    coon = MySQLdb.connect(
        host='localhost',
        user='root',
        passwd='æ‰‹åŠ¨æ‰“ç å¤„ç†',
        db='news',
        port=3306,
        charset='utf8'
    )
    cursor = coon.cursor()
    cursor.execute('SELECT * FROM news;')
    rest = cursor.fetchone()
    cursor.close()
    coon.close()
    print(rest)
except MySQLdb.Error as e:
    print('Error: %s' % e)

&gt;&gt;&gt; (1, 'ä¸°æ”¶èŠ‚åç¬¬äºŒå¤© ä¹ è¿‘å¹³è€ƒå¯Ÿäº†è¿™ä¸ªåœ°æ–¹', 'xl', '9æœˆ25æ—¥ï¼Œä¹ è¿‘å¹³æŠµè¾¾ä¸­å›½â€œæœ€æ—©è¿æ¥å¤ªé˜³çš„å¦åŒº', 1, datetime.datetime(2018, 9, 26, 11, 14, 44), None, 'ç™¾å®¶')
</code></pre>
<p>åˆšå¼€å§‹è¿è¡Œçš„æ—¶å€™æ€»ä¼šæŠ¥é”™ï¼Œæ‰€ä»¥ç”¨äº†ä¸€ä¸ª<code>try</code>è¯­å¥æ¥æ•è·é”™è¯¯ï¼š<br>
<img src="https://raw.githubusercontent.com/Tudouvvv/Pic_path/master/2018-09-26-2029%E9%94%99%E8%AF%AF.png" alt=""><br>
æŸ¥è¯¢åå¾—çŸ¥è¿™æ˜¯å› ä¸ºåœ¨MySQL8.0æ”¹å˜äº†è®¤è¯æ–¹å¼ï¼Œç›®å‰æœ€æ–°çš„MySQL8.0å¯¹ç”¨æˆ·å¯†ç çš„åŠ å¯†æ–¹å¼ä¸º<code>caching_sha2_password</code>, å¯èƒ½MySQLdbè¿˜ä¸æ”¯æŒï¼Œæ‰€ä»¥éœ€è¦æ›´æ”¹ä¸ºè€ç‰ˆæœ¬çš„è®¤è¯æ–¹å¼<code>mysql_native_password</code>,æ›´æ”¹æ–¹å¼ï¼š</p>
<pre><code>mysql -u root -p  \ç™»å½•mysql
use mysql;           
select user,plugin from user where user='root';     \æ‰§è¡Œå‘½ä»¤æŸ¥çœ‹åŠ å¯†æ–¹å¼
alter user 'root'@'localhost' identified with mysql_native_password by 'yourpassword' \æ‰§è¡Œå‘½ä»¤ä¿®æ”¹åŠ å¯†æ–¹å¼
flush privileges                  \å±æ€§æƒé™ä½¿é…ç½®ç”Ÿæ•ˆ
</code></pre>
<p>åæ­£æœ€åæˆåŠŸè§£å†³é”™è¯¯ï¼Œè¿æ¥åˆ°äº†æœ¬åœ°æ•°æ®åº“è¾“å‡ºäº†ç¬¬ä¸€æ¡æ•°æ®(å› ä¸ºç”¨äº†<code>fetchone</code>å‘½ä»¤)ï¼Œä½†æ˜¯å¯ä»¥çœ‹åˆ°è¾“å‡ºçš„ç»“æœæ˜¯ä¸€ä¸ªå…ƒç»„ï¼Œå¯èƒ½ä¼šä¸æ¸…æ¥šé‡Œé¢å„ä¸ªå…ƒç´ çš„å«ä¹‰æ˜¯ä»€ä¹ˆï¼Œè¦æ˜¯æƒ³å»ºç«‹ä¸€ç§æ˜ å°„å…³ç³»ï¼Œæˆ‘ä»¬éœ€è¦ç”¨åˆ°<code>cursor</code>çš„<code>description</code>æ–¹æ³•æ¥æŸ¥çœ‹æ¯ä¸ªå­—æ®µçš„æŸ¥è¯¢åï¼Œç„¶åæŠŠæ‰§è¡Œsqlåçš„ç»“æœä¸æ‰§è¡Œ<code>cursor.description()</code>åçš„ç»“æœæ‹¼æˆä¸€ä¸ªå­—å…¸ï¼š</p>
<pre><code class="language-python">    def get_one(self):
        # å‡†å¤‡sql
        sql = 'SELECT * FROM news WHERE news_type = %s ORDER BY create_at DESC'
        # æ‰¾åˆ°cursor
        cursor = self.conn.cursor()
        # æ‰§è¡Œsql
        cursor.execute(sql, ('ç™¾å®¶',))
        print(cursor.description)
        # æ‹¿åˆ°ç»“æœ
        rest = dict(zip([k[0] for k in cursor.description], cursor.fetchone()))
        # å¤„ç†æ•°æ®
        print(rest)
        print(rest['title'])
        # å…³é—­è¿æ¥ï¼Œcursor
        cursor.close()
        self.close_conn()
        return rest
&gt;&gt;&gt; (('id', 2, 1, 6, 6, 0, 0), ('title', 253, 71, 600, 600, 0, 0), ('img_url', 253, 2, 600, 600, 0, 0), ('content', 253, 133, 6000, 6000, 0, 0), ('is_valid', 1, 1, 4, 4, 0, 1), ('create_at', 12, 19, 19, 19, 0, 1), ('updated_at', 12, 0, 19, 19, 0, 1), ('news_type', 253, 6, 600, 600, 0, 1))
{'id': 9, 'title': 'ç”·å­3ä¸ªæœˆç«Ÿ&quot;ç”¨&quot;æ°´11å¨:å®¶ä¸­åŠå¹´æ²¡äºº æ°´è¡¨è‡ªå·±è½¬', 'img_url': 'xl', 'content': 'è¿‘æ—¥ï¼Œéƒ‘å·å¸‚æ°‘åˆ˜å…ˆç”Ÿå‘æ²³å—å•†æŠ¥è®°è€…åæ˜ ï¼Œç©ºç©ºå¦‚ä¹Ÿçš„æˆ¿å­ï¼Œæ°´è¡¨å´è‡ªå·±è½¬èµ·æ¥ï¼Œè¯¡å¼‚ä¸å·²ã€‚', 'is_valid': 1, 'create_at': datetime.datetime(2018, 9, 26, 11, 21, 59), 'updated_at': None, 'news_type': 'ç™¾å®¶'}
ç”·å­3ä¸ªæœˆç«Ÿ&quot;ç”¨&quot;æ°´11å¨:å®¶ä¸­åŠå¹´æ²¡äºº æ°´è¡¨è‡ªå·±è½¬
</code></pre>
<p>çœ‹åˆ°æ‰§è¡Œ<code>cursor.description()</code>åçš„ç»“æœæ˜¯å­—æ®µçš„æŸ¥è¯¢åå’Œä¸€ä¸²ä¸çŸ¥é“ä»€ä¹ˆæ„æ€çš„æ•°å­—ğŸ˜°ï¼Œç¬¬ä¸€æ¬¡ç”¨äº†<code>zip()</code>å’Œ<code>dict()</code>ä¸¤ä¸ªæ–¹æ³•ï¼Œzip()å¯ä»¥æŠŠä¸¤ä¸ªå…ƒç»„çš„å¯¹åº”å…ƒç´ ä¸€ä¸€æ‰“åŒ…ï¼Œè¿”å›ä¸€ä¸ªzipå¯¹è±¡ï¼Œè€Œdictå¯ä»¥æŠŠä¸¤ä¸ªå…ƒç´ ç»„åˆèµ·æ¥å˜æˆä¸€ä¸ªå­—å…¸ï¼š</p>
<pre><code class="language-python">a = (1, 2, 3, 4)
b = ('a', 'b', 'c', 'd')
print(type(zip(a, b)))
print(zip(a, b))
print(dict(zip(a, b)))

r = ((1, 'a'), (2, 'b'), (3, 'c'), (4, 'd'))
print(dict(r))

&gt;&gt;&gt; &lt;class 'zip'&gt;
    &lt;zip object at 0x000001F4AADEDC88&gt;
    {1: 'a', 2: 'b', 3: 'c', 4: 'd'}
    {1: 'a', 2: 'b', 3: 'c', 4: 'd'}
</code></pre>
<p>è¿˜ä»¥é€šè¿‡<code>fetchall()</code>çš„æ–¹æ³•è·å¾—å¤šä¸ªæ•°æ®åº“æ•°æ®ï¼Œå…³é”®æ˜¯è¦çœ‹ä½ çš„sqlè¯­å¥æ€ä¹ˆå†™ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥åœ¨sqlè¯­å¥ä¸­ç”¨<code>%s</code>ï¼Œè¿™æ˜¯ä¸€ç§å­—ç¬¦ä¸²æ ¼å¼åŒ–çš„è¯­æ³•ï¼ŒåŸºæœ¬ç”¨æ³•æ˜¯å°†å€¼æ’å…¥åˆ°%så ä½ç¬¦çš„å­—ç¬¦ä¸²ä¸­ã€‚</p>
<p>å¹¶ä¸”å¯ä»¥é€šè¿‡å†™sqlè¯­å¥å’Œ<code>commit()</code>æ¥æ·»åŠ æ•°æ®ï¼š</p>
<pre><code class="language-python"> def add(self):
        try:
            # å‡†å¤‡sql
            sql = ('INSERT INTO news (title, img_url, content, is_valid, \
                   news_type) VALUES'
                   '(%s,%s,%s,%s,%s);')
            # è·å–è¿æ¥å’Œcursor
            cursor = self.conn.cursor()
            # æ‰§è¡Œsql
            # # æäº¤æ•°æ®åˆ°æ•°æ®åº“
            cursor.execute(sql, ('æ ‡é¢˜1', 'xl', 'å†…å®¹', 1, 'å›½é™…'))
            cursor.execute(sql, ('æ ‡é¢˜2', 'xl', 'å†…å®¹', 'ä½ å¥½', 'å›½é™…', '123'))
            # æäº¤äº‹åŠ¡
            self.conn.commit()    # commitçš„ä½œç”¨æ˜¯æŠŠç¼“å­˜ä¸­çš„æ•°æ®å­˜å…¥æˆ‘ä»¬çš„æ•°æ®åº“ä¸­
            # å…³é—­cursorå’Œè¿æ¥
            cursor.close()
        except:
            print('Error')
            self.conn.commit()  # åªä¼šæäº¤æˆåŠŸçš„æ•°æ®ï¼Œå¤±è´¥çš„ä¸ä¼šæäº¤
            # self.conn.rollback() # å¦‚æœæäº¤çš„æ•°æ®ä¸­å‡ºç°ä¸€ä¸ªé”™è¯¯ï¼Œé‚£ä¹ˆéƒ½ä¸ä¼šè¢«æäº¤åˆ°æ•°æ®åº“
        self.conn.close()
</code></pre>
<p>åœ¨æ·»åŠ æ•°æ®æ—¶ä¸€å®šè¦æ³¨æ„æˆ‘ä»¬è®¾å®šçš„æ•°æ®è¡¨æ¯ä¸ªå­—æ®µçš„ç±»å‹ï¼Œä¸èƒ½å‡ºé”™ã€‚</p>
<p>å®Œæ•´ä»£ç ï¼š</p>
<pre><code class="language-python">import MySQLdb


class MysqlSearch():

    def __init__(self):
        self.get_conn()

    def get_conn(self):
        try:
            self.conn = MySQLdb.connect(
                host='127.0.0.1',
                user='root',
                passwd='mysql,,2012',
                db='news',
                port=3306,
                charset='utf8'
            )
        except MySQLdb.Error as e:
            print('Error:%s' % e)

    def close_conn(self):
        try:
            if self.conn:
                self.conn.close()
        except MySQLdb.Error as e:
            print('Error:%s' % e)

    def get_one(self):
        # å‡†å¤‡sql
        sql = 'SELECT * FROM news WHERE news_type = %s ORDER BY create_at DESC'
        # æ‰¾åˆ°cursor
        cursor = self.conn.cursor()
        # æ‰§è¡Œsql
        cursor.execute(sql, ('ç™¾å®¶',))
        print(cursor.description)
        # æ‹¿åˆ°ç»“æœ
        rest = dict(zip([k[0] for k in cursor.description], cursor.fetchone()))
        # å¤„ç†æ•°æ®
        print(rest)
        print(rest['title'])
        # å…³é—­è¿æ¥ï¼Œcursor
        cursor.close()
        self.close_conn()
        return rest

    def get_more(self, page, page_size):
        offset = (page - 1) * page_size
        # å‡†å¤‡sql
        sql = 'SELECT * FROM news WHERE news_type = %s ORDER BY create_at DESC\
               LIMIT %s,%s ;'
        # æ‰¾åˆ°cursor
        cursor = self.conn.cursor()
        # æ‰§è¡Œsql
        cursor.execute(sql, ('ç™¾å®¶', offset, page_size))
        # print(cursor.description)
        # æ‹¿åˆ°ç»“æœ
        rest = [dict(zip([k[0] for k in cursor.description], row))for row in
                cursor.fetchall()]
        # rest = cursor.fetchall()
        # å¤„ç†æ•°
        # print(rest)
        # print(rest['title'])
        # å…³é—­è¿æ¥ï¼Œcursor
        cursor.close()
        self.close_conn()
        return rest      

    def add(self):
        try:
            # å‡†å¤‡sql
            sql = ('INSERT INTO news (title, img_url, content, is_valid, \
                   news_type) VALUES'
                   '(%s,%s,%s,%s,%s);')
            # è·å–è¿æ¥å’Œcursor
            cursor = self.conn.cursor()
            # æ‰§è¡Œsql
            # æäº¤æ•°æ®åˆ°æ•°æ®åº“
            cursor.execute(sql, ('æ ‡é¢˜8', 'xl', 'å†…å®¹', 1, 'å›½é™…'))
            cursor.execute(sql, ('æ ‡é¢˜9', 'xl', 'å†…å®¹', 'ä½ å¥½', 'å›½é™…', '123'))
            # æäº¤äº‹åŠ¡
            self.conn.commit()    # commitçš„ä½œç”¨æ˜¯æŠŠç¼“å­˜ä¸­çš„æ•°æ®å­˜å…¥æˆ‘ä»¬çš„æ•°æ®åº“ä¸­
            # å…³é—­cursorå’Œè¿æ¥
            cursor.close()
        except:
            print('Error')
            self.conn.commit()  # åªä¼šæäº¤æˆåŠŸçš„æ•°æ®ï¼Œå¤±è´¥çš„ä¸ä¼šæäº¤
            # self.conn.rollback() # å¦‚æœæäº¤çš„æ•°æ®ä¸­å‡ºç°ä¸€ä¸ªé”™è¯¯ï¼Œé‚£ä¹ˆéƒ½ä¸ä¼šè¢«æäº¤åˆ°æ•°æ®åº“
        self.close_conn()


def main():
    obj = MysqlSearch()
    # rest = obj.get_one()
    rest = obj.get_more(2, 2)
    print(rest)
    # for item in rest:
    #     print(item)
    #     print('-------')
    # obj.add()

if __name__ == '__main__':
    main()
</code></pre>
<h2 id="2-orm">2ã€ORM</h2>
<p>ORMï¼šå¯¹è±¡å…³ç³»æ˜ å°„(Object Relational Mappingï¼Œç®€ç§°ORMï¼Œæˆ–O/RMï¼Œæˆ–O/R mappingï¼‰ï¼Œæ˜¯ä¸€ç§ç¨‹åºæŠ€æœ¯ï¼Œç”¨äºå®ç°é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€é‡Œä¸åŒç±»å‹ç³»ç»Ÿçš„æ•°æ®ä¹‹é—´çš„è½¬æ¢ ã€‚ä»æ•ˆæœä¸Šè¯´ï¼Œå®ƒå…¶å®æ˜¯åˆ›å»ºäº†ä¸€ä¸ªå¯åœ¨ç¼–ç¨‹è¯­è¨€é‡Œä½¿ç”¨çš„--â€œè™šæ‹Ÿå¯¹è±¡æ•°æ®åº“â€ã€‚</p>
<p>è¿™æ˜¯ç™¾åº¦ç™¾ç§‘é‡Œçš„ä»‹ç»ï¼Œåœ¨å‰é¢æˆ‘ä»¬ç”¨mysqldbè¿™ä¸ªåŒ…çš„æ—¶å€™ï¼Œå®ƒåªæ˜¯è¾“å‡ºäº†æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œæˆ‘ä»¬è¿˜æ˜¯ç”¨zipå’Œdescriptionå¼ºè¡Œå»ºç«‹ä¸€ç§æ˜ å°„å…³ç³»ï¼Œå¹¶ä¸”è¿˜è¦å†™sqlè¯­å¥ï¼Œè€Œåœ¨ORMä¸­ï¼Œæˆ‘ä»¬ä¸éœ€è¦å…³å¿ƒè¿™äº›ä¸œè¥¿ï¼Œæˆ‘ä»¬åªè¦æŒ‰ç…§ORMçš„å¥—è·¯æ¥å°±è¡Œã€‚</p>
<p>å¸¸ç”¨çš„ORMå®ç°æ–¹æ³•æœ‰SqlObjectã€peeweeã€Django's ORM  ã€SQLAlchemy</p>
<h3 id="sqlalchemyå­¦ä¹ ">SQLAlchemyå­¦ä¹ </h3>
<p><code>https://docs.sqlalchemy.org/en/latest/orm/</code>------&gt;å®˜æ–¹æ–‡æ¡£åœ°å€<br>
åœ¨MySQLä¸­ä¸åŒå­—ç¬¦ç±»å‹åœ¨sqlalchemyä¸­éƒ½æœ‰å¯¹åº”çš„ç±»å‹ä¸ä¹‹åŒ¹é…ï¼Œæ¯”å¦‚VARCHARå¯¹åº”Stringï¼ŒINTå¯¹åº”Integerã€‚</p>
<h4 id="åˆ›å»ºä¸€å¼ è¡¨">åˆ›å»ºä¸€å¼ è¡¨</h4>
<p>å¦‚æœæˆ‘ä»¬æƒ³åœ¨æŸä¸ªæ•°æ®åº“ä¸­åˆ›å»ºä¸€ä¸ªè¡¨ï¼Œæˆ‘ä»¬é¦–å…ˆè¦ç”¨åˆ°<code>engine</code>æ¥ä¸æ•°æ®åº“å»ºç«‹è¿æ¥ï¼Œæ¥ç€ç»§æ‰¿<code>Base</code>è¿™ä¸ªåŸºç±»ä¸­çš„æ–¹æ³•æ¥åŒæˆ‘ä»¬çš„æ•°æ®åº“è¿›è¡Œæ˜ å°„ï¼Œæ¥ç€å®šä¹‰æ•°æ®è¡¨çš„æ¯ä¸ªå­—æ®µçš„ç±»å‹ï¼Œæœ€åé€šè¿‡ä¸‹å›¾ä¸­çš„æ–¹æ³•æ¥åˆ›å»ºæ•°æ®è¡¨ï¼š</p>
<center>![](https://raw.githubusercontent.com/Tudouvvv/Pic_path/master/2018-09-26-py%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E8%A1%A8.png)</center>
æˆ‘ä»¬å¯ä»¥çœ‹åˆ°`Base.metadta.create_all(engine)`è¿™æ¡è¯­å¥å°±ç›¸å½“äºä¸€æ¡sqlè¯­å¥ï¼Œç¼–å†™ä»£ç æ¥å®éªŒä¸€ä¸‹ï¼š
```python
from sqlalchemy import create_engine
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy import Column, Integer, String, DateTime, Boolean
<h1 id="engine-create_enginemysqlscotttigerlocalhostfoo-å®˜æ–¹ç»™å‡ºçš„è¿æ¥æ–¹æ³•">engine = create_engine('mysql://scott:tiger@localhost/foo') #å®˜æ–¹ç»™å‡ºçš„è¿æ¥æ–¹æ³•</h1>
<h1 id="scott-ç”¨æˆ·å-triger-å¯†ç -fooæ•°æ®åº“">scott ç”¨æˆ·å triger å¯†ç   fooæ•°æ®åº“</h1>
<p>engine = create_engine('mysql://root:æ‰‹åŠ¨æ‰“ç æ­¤å¤„çš„å¯†ç è™½ç„¶æ²¡æœ‰ä»€ä¹ˆåµç”¨@localhost:3306/news_test')<br>
Base = declarative_base()  # sqlalchemyå®šä¹‰çš„ä¸€ä¸ªåŸºç±»</p>
<p>class News(Base):<br>
<strong>tablename</strong> = 'news'<br>
id = Column(Integer, primary_key=True)<br>
title = Column(String(200), nullable=False)<br>
img_url = Column(String(200), nullable=False)<br>
content = Column(String(2000), nullable=False)<br>
is_valid = Column(Boolean)<br>
create_at = Column(DateTime)<br>
update_at = Column(DateTime)<br>
news_type = Column(String(20))</p>
<p>News.metadata.create_all(engine)</p>
<pre><code>
å¯ä»¥åœ¨å›¾å½¢åŒ–çš„mysqlæ•°æ®åº“ä¸­çœ‹åˆ°ï¼Œå·²ç»æˆåŠŸçš„åˆ›å»ºäº†ä¸€å¼ æ•°æ®è¡¨ã€‚
![](https://raw.githubusercontent.com/Tudouvvv/Pic_path/master/2018-09-26-%E6%96%B0%E5%BB%BA%E4%B8%80%E5%BC%A0%E6%95%B0%E6%8D%AE%E8%A1%A8.png)


#### æ–°å¢æ•°æ®
åœ¨å‰é¢å­¦äº›mysqldbçš„æ—¶å€™ï¼Œæ— è®ºæ—¶æ–°å¢æ•°æ®è¿˜æ˜¯åˆ é™¤æ•°æ®ï¼Œéƒ½éœ€è¦å€ŸåŠ©ä¸€ä¸ªæ¸¸æ ‡æ¥å®Œæˆæ“ä½œï¼Œè€Œåœ¨sqlalchemyä¸­ï¼Œéœ€è¦å€ŸåŠ©`session`ï¼š
![](https://raw.githubusercontent.com/Tudouvvv/Pic_path/master/2018-09-26-%E5%88%9B%E5%BB%BAsession.png)
æˆ‘ä»¬æ¥è¯•éªŒä¸€ä¸‹ï¼š
```python
class AddTest():
    def __init__(self):
        self.session = Session()

    def add(self):
        news_obj = News(
            title='æ ‡é¢˜1',
            img_url='xxx/xxx/xxx.jpg',
            content='å†…å®¹1',
            create_at=datetime.datetime.now(),
            news_type='å›½é™…'
        )
        self.session.add(news_obj)
        self.session.commit()
        return news_obj
</code></pre>
<p>æ‰§è¡Œå‡ æ¬¡ä»¥åå‘ç°ï¼Œæ•°æ®å·²ç»è¢«æ·»åŠ åˆ°æ•°æ®åº“ä¸­äº†ï¼š<br>
<img src="https://raw.githubusercontent.com/Tudouvvv/Pic_path/master/2018-09-26-%E6%B7%BB%E5%8A%A0%E4%B8%80%E6%9D%A1%E6%95%B0%E6%8D%AE.png" alt=""></p>
<p>ä¸è¿‡è¿™é‡Œæˆ‘æœ‰ä¸€ç‚¹ç–‘æƒ‘ï¼Œå› ä¸ºåœ¨å†™sqlè¯­å¥çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¦è®©idè‡ªå¢å¿…é¡»å¡«å…¥<code>AUTO_INCREMENT</code>å†åŠ ä¸»é”®çº¦æŸæ‰å¯ä»¥ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆåœ¨è¿™é‡Œåªéœ€è¦æ ‡æ˜æ˜¯ä¸»é”®çº¦æŸå°±å¯ä»¥äº†ã€‚<br>
æ·»åŠ å¤šæ¡æ•°æ®æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å¡«å†™å¤šä¸ª<code>session.add()</code>è¯­å¥ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨<code>session.add_all()</code>è¯­å¥è¿›è¡Œæ·»åŠ ï¼š</p>
<pre><code class="language-python">self.session.add_all((news_obj1, news_obj2, news_obj3))
</code></pre>

            </div>
            
              <div class="tag-container">
                
                  <a href="https://tudouvvv.github.io//tag/python" class="tag">
                    Python
                  </a>
                
                  <a href="https://tudouvvv.github.io//tag/mysql" class="tag">
                    Mysql
                  </a>
                
              </div>
            
            
              <div class="next-post">
                <div class="next">ä¸‹ä¸€ç¯‡</div>
                <a href="https://tudouvvv.github.io//post/çŒ«çœ¼ç”µå½±TOP100çˆ¬å–">
                  <h3 class="post-title">
                    çŒ«çœ¼ç”µå½±TOP100çˆ¬å–
                  </h3>
                </a>
              </div>
            

            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>

<script type="application/javascript">

AOS.init();

hljs.initHighlightingOnLoad()

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>




  </body>
</html>
