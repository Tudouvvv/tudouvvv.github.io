<!DOCTYPE html>
<html>
  <head>
      
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Tudouvvv</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<meta name="description" content="äººç”Ÿè¿˜é•¿ï¼Œæ…¢æ…¢æ¥"/>
<meta name="keywords" content="äººç”Ÿè¿˜é•¿ï¼Œæ…¢æ…¢æ¥"/>

<!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
<link rel="shortcut icon" href="https://tudouvvv.github.io//favicon.ico">

<link rel="stylesheet" href="https://tudouvvv.github.io//styles/main.css">

<!-- Modernizr JS -->
<script src="https://tudouvvv.github.io//media/scripts/_vendors/modernizr-2.6.2.min.js"></script>
<!-- FOR IE9 below -->
<!--[if lt IE 9]>
<scripts src="https://tudouvvv.github.io//media/scripts/_vendors/respond.min.js"></scripts>
<![endif]-->

<!-- Comment -->


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/tomorrow-night.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
<link crossorigin="anonymous" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" href="https://lib.baomitu.com/font-awesome/5.8.1/css/all.min.css" rel="stylesheet">

  </head>
  <body>
  
<div id="fh5co-offcanvas">
    <a href="#!" class="fh5co-close-offcanvas js-fh5co-close-offcanvas">
        <span><i class="icon-cross3"></i> <span>Close</span></span>
    </a>
    <div class="fh5co-bio">
        <figure>
            <img src="https://tudouvvv.github.io//media/images/avatar.png" alt="Tudouvvv" class="img-responsive">
        </figure>
        <h3 class="heading">ABOUT ME</h3>
        <h2>Tudouvvv</h2>
        <p>äººç”Ÿè¿˜é•¿ï¼Œæ…¢æ…¢æ¥</p>
        <ul class="fh5co-social">
            
                <li>
                    
                </li>
            
                <li>
                    
                </li>
            
                <li>
                    
                </li>
            
                <li>
                    
                </li>
            
                <li>
                    
                </li>
            
        </ul>
    </div>

    <div class="fh5co-menu">
        <div class="fh5co-box">
            <h3 class="heading">æœç´¢</h3>
            <form action="#">
                <div class="form-group">
                    <input type="text" class="form-control" placeholder="è¾“å…¥å…³é”®å­—">
                </div>
            </form>
        </div>
        <div class="fh5co-box">
            <h3 class="heading">æ ‡ç­¾</h3>
            <ul>
                
                    <li><a href="https://tudouvvv.github.io//tag/leetcode">Leetcode</a></li>
                
                    <li><a href="https://tudouvvv.github.io//tag/python">Python</a></li>
                
                    <li><a href="https://tudouvvv.github.io//tag/keras">Keras</a></li>
                
                    <li><a href="https://tudouvvv.github.io//tag/mysql">Mysql</a></li>
                
                    <li><a href="https://tudouvvv.github.io//tag/code">Code</a></li>
                
                    <li><a href="https://tudouvvv.github.io//tag/Ejc-I2BJt">Life</a></li>
                
            </ul>
        </div>
    </div>
</div>

<header id="fh5co-header">
    <div class="container-fluid">
        <div class="row">
            <a href="#" class="js-fh5co-nav-toggle fh5co-nav-toggle"><i></i></a>
            <ul class="fh5co-social">
                
                    <li>
                        <a href="/"
                         >
                            é¦–é¡µ
                        </a>
                    </li>
                
                    <li>
                        <a href="/archives"
                         >
                            å½’æ¡£
                        </a>
                    </li>
                
                    <li>
                        <a href="/tags"
                         >
                            æ ‡ç­¾
                        </a>
                    </li>
                
                    <li>
                        <a href="/post/about"
                         >
                            å…³äº
                        </a>
                    </li>
                
            </ul>
            <div class="col-lg-12 col-md-12 text-center">
                <h1 id="fh5co-logo">
                    <a href="https://tudouvvv.github.io/">Tudouvvv</a>
                </h1>
            </div>
        </div>
    </div>
</header>


<!--  <a href="#" class="fh5co-post-prev"><span>ğŸ‘ˆ Prev</span></a>-->
<!--  <a href="#" class="fh5co-post-next"><span>Next ğŸ‘‰</span></a>-->

  <div class="container-fluid">
      <div class="row fh5co-post-entry single-entry">
          <article class="col-lg-8 col-lg-offset-2 col-md-8 col-md-offset-2 col-sm-8 col-sm-offset-2 col-xs-12 col-xs-offset-0">
              <figure class="animate-box">
                  
                      <img src="https://raw.githubusercontent.com/Tudouvvv/Pic_path/master/2018-10-19-cat.jpeg" alt="ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ -ç¬¬äºŒå‘¨ä½œä¸š" class="img-responsive">
                  
              </figure>
              <span class="fh5co-meta animate-box">
                  
                      <div class="tag-container">
                          
                              <a href="https://tudouvvv.github.io//tag/python" class="tag">Python, </a>
                          
                      </div>
                  
              </span>
              <h2 class="fh5co-article-title animate-box">ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ -ç¬¬äºŒå‘¨ä½œä¸š</h2>
              <span class="fh5co-meta fh5co-date animate-box">2018-10-19</span>

              <div class="col-lg-12 col-lg-offset-0 col-md-12 col-md-offset-0 col-sm-12 col-sm-offset-0 col-xs-12 col-xs-offset-0 text-left content-article">
                  <div class="row">
                      <div class="col-md-12 animate-box post-content">
                          <p> <p>å­¦ä¹ äº†æœ¬å‘¨çš„å†…å®¹ï¼Œå¯¹äºlogisticå›å½’å’Œæ¢¯åº¦ä¸‹é™æ³•æœ‰äº†ä¸€å®šçš„äº†è§£ï¼Œæ°å¥½æœ‰ä½œä¸šå¯ä»¥æŠŠå­¦ä¹ çš„å†…å®¹ä¸²è”èµ·æ¥ï¼Œäºæ˜¯åŠ¨æ‰‹å†™ä¸€ä¸‹ï¼Œå­¦ä¹ è¿‡ç¨‹ä¸­é‡åˆ°äº†å¾ˆå¤šé—®é¢˜ï¼Œæ„Ÿè°¢é˜¿æ¯›çš„å‹æƒ…å¸®åŠ©ã€‚<br>
å‚è€ƒæ–‡ç« ï¼š<a href="https://github.com/Kulbear/deep-learning-coursera/blob/master/Neural%20Networks%20and%20Deep%20Learning/Logistic%20Regression%20with%20a%20Neural%20Network%20mindset.ipynb">Logistic Regression with a Neural Network mindset</a></p>
<h1 id="ç›®æ ‡è¯†åˆ«å›¾ç‰‡ä¸­æœ‰æ²¡æœ‰çŒ«">ç›®æ ‡ï¼šè¯†åˆ«å›¾ç‰‡ä¸­æœ‰æ²¡æœ‰çŒ«</h1>
<h1 id="æ­¥éª¤">æ­¥éª¤ï¼š</h1>
<h2 id="1-å‡†å¤‡å·¥ä½œ">1ã€å‡†å¤‡å·¥ä½œ</h2>
<p>ä¸‹è½½äº†ç›¸å…³æ–‡ä»¶(æ•°æ®é›†)ï¼Œè®­ç»ƒé›†å…±æœ‰209å¼ å›¾ç‰‡ï¼Œæµ‹è¯•é›†50å¼ å›¾ç‰‡<br>
åˆ†ç±»æ–¹æ³•ï¼šæœ‰çŒ«ä¸º1ï¼Œæ²¡æœ‰çŒ«ä¸º0<br>
å¯¼å…¥ç›¸å…³çš„åŒ…:</p>
<pre><code class="language-python">import numpy as np
import h5py
import matplotlib.pyplot as plt
import matplotlib.image as mpimg
</code></pre>
<h2 id="2-æ•°æ®å¤„ç†">2ã€æ•°æ®å¤„ç†</h2>
<pre><code class="language-python">def load_dataset():
    train_dataset = h5py.File('datasets/train_catvnoncat.h5', &quot;r&quot;) # h5pyè¯»å–æ–‡ä»¶ï¼Œè¦åŠ r
    train_set_x_orig = np.array(train_dataset[&quot;train_set_x&quot;][:]) # è®­ç»ƒé›†æ•°æ®
    train_set_y_orig = np.array(train_dataset[&quot;train_set_y&quot;][:]) # è®­ç»ƒé›†æ ‡ç­¾

    test_dataset = h5py.File('datasets/test_catvnoncat.h5', &quot;r&quot;)
    test_set_x_orig = np.array(test_dataset[&quot;test_set_x&quot;][:]) # æµ‹è¯•é›†æ•°æ®
    test_set_y_orig = np.array(test_dataset[&quot;test_set_y&quot;][:]) # æµ‹è¯•é›†æ ‡ç­¾

    classes = np.array(test_dataset[&quot;list_classes&quot;][:]) # the list of classes

    train_set_y_orig = train_set_y_orig.reshape((1, train_set_y_orig.shape[0]))
    test_set_y_orig = test_set_y_orig.reshape((1, test_set_y_orig.shape[0]))

    return train_set_x_orig, train_set_y_orig, test_set_x_orig, test_set_y_orig, classes


train_set_x_orig, train_set_y, test_set_x_orig, test_set_y, classes = load_dataset()
</code></pre>
<p>è¿™ä¸€éƒ¨åˆ†ä»£ç æ˜¯èµ„æ–™ä¸­ç»™çš„ï¼Œä¸»è¦ä½œç”¨æ˜¯ä»æ•°æ®é›†ä¸­è¯»å–æ•°æ®ï¼Œç›´æ¥æ‹¿æ¥ç”¨å°±å¥½ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹è®­ç»ƒé›†ä¸­ç¬¬88å¼ å›¾ç‰‡çš„ä¿¡æ¯ä»¥åŠå›¾ç‰‡åˆ°åº•æ˜¯ä»€ä¹ˆæ ·çš„ï¼š</p>
<pre><code class="language-python">train_set_x_orig, train_set_y, test_set_x_orig, test_set_y, classes = load_dataset()

index = 88
img = train_set_x_orig[index]
print(img.shape)
plt.imshow(img)
plt.show()

&gt;&gt;&gt; (64, 64, 3)
</code></pre>
<p>imgå‚¨å­˜çš„æ˜¯å›¾ç‰‡ä¿¡æ¯ï¼Œè®¡ç®—æœºè¦ä¿å­˜ä¸€å¼ ç…§ç‰‡ï¼Œè¦ä¿å­˜ä¸ºä¸‰ä¸ªç‹¬ç«‹çŸ©é˜µï¼Œå› ä¸ºå›¾ç‰‡çš„åƒç´ æ˜¯ç”±ä¸‰åŸè‰²(R,G,B)æ„æˆçš„ï¼Œæ¯ä¸ªçŸ©é˜µä¿å­˜ç€æ¯ä¸ªå•åŸè‰²åœ¨å„åƒç´ å¤„çš„äº®åº¦ï¼Œæ‰€ä»¥imgæ˜¯ä¸€ä¸ªç»´åº¦ä¸º(64, 64, 3)çš„æ•°ç»„ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>matplotlib</code>è¿™ä¸ªåŒ…çš„<code>image</code>æ¨¡å—ä¸‹çš„<code>imshow</code>å‡½æ•°æ¥å¯¹å›¾ç‰‡ä¿¡æ¯è¿›è¡Œ&quot;ç¼–è¯‘&quot;,è¾“å‡ºå›¾ç‰‡å…·ä½“çš„æ ·å­ï¼Œåé¢è¦åŠ <code>plt.show()</code>æ¥æ˜¾ç¤ºå›¾ç‰‡ï¼š</p>
<center>![](https://raw.githubusercontent.com/Tudouvvv/Pic_path/master/2018-10-19-88%E5%9B%BE%E7%89%87%E4%BF%A1%E6%81%AF.png)</center>
<p>ç¼–å†™ä»£ç æ¥è¾“å‡ºæœ¬æ¬¡æ¨¡æ‹Ÿçš„ç›¸å…³ä¿¡æ¯ï¼š</p>
<pre><code class="language-python">
number_train = train_set_y.shape[1]
number_test = test_set_y.shape[1]
number_px = train_set_x_orig.shape[1]

print(&quot;è®­ç»ƒé›†å›¾ç‰‡çš„æ•°é‡:&quot;, number_train)
print(&quot;æµ‹è¯•é›†å›¾ç‰‡çš„æ•°é‡:&quot;, number_test)
print(&quot;æ¯å¼ å›¾ç‰‡çš„å¤§å°:&quot;, number_px, &quot;*&quot;, number_px)
print(&quot;è®­ç»ƒé›†æ•°æ®çš„ç»´æ•°:&quot;, train_set_x_orig.shape)
print(&quot;è®­ç»ƒé›†æ ‡ç­¾çš„ç»´æ•°:&quot;, train_set_y.shape)
print(&quot;æµ‹è¯•é›†æ•°æ®çš„ç»´æ•°:&quot;, test_set_x_orig.shape)
print(&quot;æµ‹è¯•é›†æ ‡ç­¾çš„ç»´æ•°:&quot;, test_set_y.shape)

&gt;&gt;&gt;

è®­ç»ƒé›†å›¾ç‰‡çš„æ•°é‡: 209
æµ‹è¯•é›†å›¾ç‰‡çš„æ•°é‡: 50
æ¯å¼ å›¾ç‰‡çš„å¤§å°: 64 * 64
è®­ç»ƒé›†æ•°æ®çš„ç»´æ•°: (209, 64, 64, 3)
è®­ç»ƒé›†æ ‡ç­¾çš„ç»´æ•°: (1, 209)
æµ‹è¯•é›†æ•°æ®çš„ç»´æ•°: (50, 64, 64, 3)
æµ‹è¯•é›†æ ‡ç­¾çš„ç»´æ•°: (1, 50)
</code></pre>
<p>ç”±äºå›¾ç‰‡çš„ç»´åº¦æ˜¯ä¸€ä¸ª(64, 64, 3)çš„numpyæ•°ç»„ï¼Œä¸ºäº†è®­ç»ƒçš„æ–¹ä¾¿ï¼Œæˆ‘ä»¬éœ€è¦æŠŠä¸€å¼ å›¾ç‰‡ä¸Šçš„ä¿¡æ¯æ•´åˆåˆ°ä¸€èµ·ï¼Œå³æ„é€ æˆä¸€ä¸ª(64*64*3, 1ï¼‰çš„åˆ—å‘é‡ï¼Œç„¶åæŠŠæ‰€æœ‰çš„å›¾ç‰‡ä¿¡æ¯æ”¾åœ¨ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œæ¯ä¸€åˆ—å‚¨å­˜ç€ä¸€å¼ ç…§ç‰‡çš„ä¿¡æ¯ã€‚ä¹Ÿå°±æ˜¯è¦æŠŠè®­ç»ƒé›†å’Œæ•°æ®é›†ä¸­çš„æ•°æ®è¿›è¡Œé™ç»´å¤„ç†:</p>
<pre><code class="language-python">train_x_con = train_set_x_orig.reshape(train_set_x_orig.shape[0], -1).T
test_x_con = test_set_x_orig.reshape(test_set_x_orig.shape[0], -1).T
print(&quot;é™ç»´åè®­ç»ƒé›†æ•°æ®çš„ç»´æ•°:&quot;, train_x_con.shape)
print(&quot;é™ç»´åæµ‹è¯•é›†æ•°æ®çš„ç»´æ•°:&quot;, test_x_con.shape)

&gt;&gt;&gt; é™ç»´åè®­ç»ƒé›†æ•°æ®çš„ç»´æ•°: (12288, 209)
    é™ç»´åæµ‹è¯•é›†æ•°æ®çš„ç»´æ•°: (12288, 50)
</code></pre>
<p><code>reshape()</code>å¯ä»¥å¯¹æ•°ç»„è¿›è¡Œé‡æ–°æ„é€ ï¼Œä»¥è®­ç»ƒé›†çš„æ•°æ®ä¸ºä¾‹ï¼Œç”±äºå…±æœ‰209å¼ å›¾ç‰‡ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¾—åˆ°ä¸€ä¸ªåˆ—ä¸º209çš„æ•°ç»„ï¼Œä½†æ˜¯ç”±äºæ•°æ®é‡å¤ªå¤§ï¼Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“æœ‰å¤šå°‘è¡Œï¼Œ<code>reshape()</code>æ–¹æ³•ä¸­æœ‰ä¸€ä¸ªæœºåˆ¶ï¼Œå³è¾“å…¥è´Ÿæ•°ï¼Œå®ƒä¼šå¸®æˆ‘ä»¬ç®—å¥½è¡Œæ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿™æ ·è®¾ç½® <code>train_x_con = train_set_x_orig.reshape(-1, train_set_x_orig.shape[0])</code>ï¼Œæˆ–è€…æˆ‘ä»¬è®¾ç½®è¡Œæ•°ä¸º209ï¼Œæœ€ååŠ <code>.T</code>è½¬ç½®æ•°åˆ—å³å¯ï¼š<code>train_x_con = train_set_x_orig.reshape(train_set_x_orig.shape[0], -1).T</code>ã€‚</p>
<p>ä»¥å‰åšæ¯•è®¾çš„æ—¶å€™æœ‰å¯¹æ•°æ®è¿›è¡Œå½’ä¸€åŒ–å¤„ç†ï¼Œå› ä¸ºæ˜¯ä¸åŒç‰¹å¾çš„æ•°å­—ï¼Œå±äºå¥‡å¼‚æ ·æœ¬æ•°æ®ï¼Œå½’ä¸€åŒ–ä»¥åæ¶ˆé™¤ä¸åŒæ•°æ®é‡çº²æ•°å­—å¤§å°çš„å½±å“ï¼ŒåŠ å¿«å­¦ä¹ çš„é€Ÿåº¦ã€‚è€Œåœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œå¯¹æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–ä¹Ÿæ˜¯å¾ˆé‡è¦çš„ï¼Œåœ¨å›¾ç‰‡æ•°æ®é›†ä¸­ï¼Œç”±äºæ¯ä¸ªåƒç´ ç‚¹çš„ä¿¡æ¯æœ€å¤§ä¸º255ï¼Œæ‰€ä»¥å¯ä»¥å¯¹æ‰€æœ‰æ•°é™¤ä»¥255ï¼Œè®©æ•°æ®é›†æ•°æ®ä½äº[0, 1]ä¹‹é—´ï¼š</p>
<pre><code class="language-python">train_set_x = train_x_con /255
test_set_x = test_x_con /255
</code></pre>
<h2 id="3-è®°å½•æ€è·¯">3ã€è®°å½•æ€è·¯</h2>
<p><img src="https://raw.githubusercontent.com/Tudouvvv/Pic_path/master/2018-10-19-LogReg_kiank.png" alt=""></p>
<p>æˆ‘ä»¬æ‰€éœ€è¦ç”¨åˆ°çš„ç®—æ³•å’Œå‡½æ•°ï¼š<br>
<img src="https://raw.githubusercontent.com/Tudouvvv/Pic_path/master/2018-10-19-%E5%85%AC%E5%BC%8F.png" alt=""></p>
<p>æˆ‘ä»¬éœ€è¦åšçš„ï¼š</p>
<ul>
<li>1ã€åˆå§‹åŒ–å˜é‡w,b</li>
<li>2ã€å‰å‘ä¼ æ’­å¾—åˆ°æ¦‚ç‡å’Œæˆæœ¬å€¼J</li>
<li>3ã€åå‘ä¼ æ’­æ¥å¾—åˆ°æˆæœ¬å€¼å¯¹wå’Œbçš„å¯¼æ•°</li>
<li>4ã€é€šè¿‡æ¢¯åº¦ä¸‹é™æ³•æ¥æ›´æ–°å˜é‡wå’Œb</li>
<li>5ã€é‡å¤æ­¥éª¤2ã€3ã€4</li>
</ul>
<h2 id="4-go">4ã€Goï¼</h2>
<pre><code class="language-python">def init_variable(dim):
    w = np.zeros((dim, 1))
    b = 0
    return w, b

def sigmoid(z):
    s = 1 / (1 + np.exp(-z))
    return s
</code></pre>
<p>å®šä¹‰å‡½æ•°åˆå§‹åŒ–å˜é‡w,bï¼Œwæ˜¯æ¯ä¸ªè¾“å…¥ç‰¹å¾çš„æ‰€å æƒé‡ï¼Œæ‰€ä»¥åº”è¯¥æ˜¯ä¸€ä¸ª<code>(64*64*3ï¼Œ 1)</code>çš„åˆ—å‘é‡<br>
å®šä¹‰å‰å‘ä¼ æ’­å‡½æ•°Sigmoidçš„ä¸€èˆ¬å½¢å¼ï¼Œè¾“å…¥å‚æ•°zå¯ä»¥æ˜¯ä¸€ä¸ªnumpyæ•°ç»„</p>
<p>è¿™æ ·ï¼Œåˆå§‹åŒ–å·¥ä½œå·²ç»å®Œæˆï¼Œå¯ä»¥å¼€å§‹è¿›è¡Œå­¦ä¹ æ“ä½œäº†ï¼Œå®šä¹‰ä¼ æ’­å‡½æ•°propagateå¾—åˆ°æˆæœ¬å€¼ä»¥åŠwå’Œbçš„æ¢¯åº¦ï¼š</p>
<pre><code class="language-python">def propagate(w, b, X, Y):
    m = X.shape[1]
    
    # å‰å‘ä¼ æ’­
    A = sigmoid(np.dot(w.T, X) + b)
    cost = (-1 / m) * np.sum(Y * np.log(A) + (1 - Y) * np.log(1 - A))
    
    # åå‘ä¼ æ’­
    dw = (1 / m) * np.dot(X, (A - Y).T)
    db = (1 / m) * np.sum(A - Y)

    reci = {
        &quot;dw&quot;: dw,
        &quot;db&quot;: db
    }

    return  reci, cost
</code></pre>
<p>ä¸Šé¢ç”¨åˆ°çš„å…¬å¼éƒ½æ˜¯è§†é¢‘ä¸­æ¨å¯¼è¿‡çš„ï¼Œ<code>np.dot()</code>å¯ä»¥å®Œæˆä¸¤ä¸ªçŸ©é˜µçš„ä¹˜æ³•ï¼Œ<code>np.sum()</code>å¯ä»¥è¿›è¡Œç´¯åŠ æ“ä½œã€‚</p>
<p>æ¥ä¸‹æ¥å®šä¹‰æ¢¯åº¦ä¸‹é™å‡½æ•°optimizeæ¥è¿›è¡Œè¿­ä»£ï¼Œå³é€šè¿‡æœ€å°åŒ–æˆæœ¬Jæ¥æ›´æ–° w å’Œ bï¼š</p>
<pre><code class="language-python">def optimize(w, b, X, Y, num_iterations, learning_rate, print_cost= False):
    costs = []
    for i in range(num_iterations):
        reci, cost = propagate(w, b, X, Y)
        dw = reci[&quot;dw&quot;]
        db = reci[&quot;db&quot;]
        
        w = w - learning_rate * dw
        b = b - learning_rate * db
        
        if i % 100 == 0:
            costs.append(cost)
        if (print_cost) and (i % 100 == 0):
            print(&quot;è¿­ä»£æ¬¡æ•°:%d , è¯¯å·®å€¼: %f&quot;  %(i, cost))

    params = {
        &quot;w&quot;: w,
        &quot;b&quot;: b
    }
    return params, costs
</code></pre>
<p>è¿™é‡Œæ¨¡ä»¿å‚è€ƒæ–‡ç« ï¼Œæ¯è¿­ä»£100æ¬¡è¾“å‡ºæ­¤æ—¶è¯¯å·®å€¼ã€‚é€šè¿‡ä¸æ–­åœ°è¿­ä»£å°±å®Œæˆäº†æ•´ä¸ªå­¦ä¹ è¿‡ç¨‹ï¼Œè®¾ç½®è¿­ä»£æ¬¡æ•°<code>num_iterations</code>å¯ä»¥å†³å®šè¿­ä»£çš„æ¬¡æ•°ï¼Œæœ€åå­˜å‚¨è¿­ä»£ç»“æŸçš„å˜é‡ w å’Œ b ç”¨æ¥è¿›è¡Œé¢„æµ‹ã€‚</p>
<p>é¢„æµ‹å‡½æ•°predictçš„ä¸»è¦ä½œç”¨å°±æ˜¯é€šè¿‡å­¦ä¹ å¾—åˆ°å˜é‡wå’Œbè¿›è¡Œé¢„æµ‹å¾—åˆ°æ¦‚ç‡ï¼Œå½“æ¦‚ç‡å¤§äº0.5æ—¶ï¼Œæˆ‘ä»¬è®¤ä¸ºè¿™å¼ å›¾ç‰‡ä¸­æœ‰çŒ«ï¼Œè®¾ç½®æ ‡ç­¾å€¼ä¸º1ï¼Œå½“æ¦‚ç‡å°äº0.5æ—¶ï¼Œæˆ‘ä»¬è®¤ä¸ºå›¾ç‰‡ä¸­æ²¡æœ‰çŒ«ï¼Œè®¾ç½®æ ‡ç­¾å€¼ä¸º0ï¼Œæœ€åå°†æ‰€æœ‰çš„æ ‡ç­¾å€¼è¿›è¡Œå­˜å‚¨ç”¨æ¥è¿›è¡Œå‡†ç¡®åº¦çš„æ¯”è¾ƒï¼š</p>
<pre><code class="language-python">def predict(X, Y, w, b):
    m = X.shape[1]
    Y_prediction = np.zeros((1, m))
    w = w.reshape(X.shape[0], 1)

    A = sigmoid(np.dot(w.T, X) + b)

    for i in range(m):
        Y_prediction[0, i] = 1 if A[0, i] &gt; 0.5 else 0

    return Y_prediction
</code></pre>
<p>æœ€åè®¾ç½®mainå‡½æ•°æ¥è°ƒåŠ¨æ‰€æœ‰çš„â€˜æ¨¡å—â€™ï¼Œå¹¶é€šè¿‡å¯¹ è®­ç»ƒé›† å’Œ æµ‹è¯•é›†  æ­£ç¡®æ ‡ç­¾å€¼çš„æ¯”è¾ƒå¾—åˆ°æœ¬æ¬¡å­¦ä¹ è¿‡ç¨‹çš„å‡†ç¡®ç¨‹åº¦ï¼Œå°†æœ¬æ¬¡è®­ç»ƒåçš„å‚æ•°è¿›è¡Œä¿å­˜ï¼š</p>
<pre><code class="language-python">def main(X_train, Y_train, X_test, Y_test, num_iterations, learning_rate, print_cost):
    w, b = init_variable(X_train.shape[0])   # åˆå§‹åŒ–å˜é‡
    params, costs = optimize(w, b, X_train, Y_train, num_iterations, learning_rate, print_cost)  # è¿›è¡Œå­¦ä¹ è¿‡ç¨‹
    w, b = params[&quot;w&quot;], params[&quot;b&quot;]      # å¾—åˆ°å­¦ä¹ åçš„å˜é‡

    Y_train_prediction = predict(X_train, Y_train, w, b)  # å¯¹è®­ç»ƒé›†æ•°æ®è¿›è¡Œé¢„æµ‹
    Y_test_prediction = predict(X_test, Y_test, w, b)    # å¯¹æµ‹è¯•é›†æ•°æ®è¿›è¡Œé¢„æµ‹

    print(&quot;è®­ç»ƒé›†å‡†ç¡®åº¦:&quot;, 100 - np.mean(np.abs(Y_train - Y_train_prediction)) * 100, &quot;%&quot;)  # å¾—åˆ°è®­ç»ƒé›†å‡†ç¡®åº¦
    print(&quot;æµ‹è¯•é›†å‡†ç¡®åº¦:&quot;, 100 - np.mean(np.abs(Y_test - Y_test_prediction)) * 100, &quot;%&quot;)   # å¾—åˆ°æµ‹è¯•é›†å‡†ç¡®åº¦

    data = {
            &quot;costs&quot; : costs,
            &quot;Y_prediction_test&quot; : Y_test_prediction,
            &quot;Y_prediciton_train&quot; : Y_train_prediction,
            &quot;w&quot; : w,
            &quot;b&quot; : b,
            &quot;learning_rate&quot; : learning_rate,
            &quot;num_iterations&quot; : num_iterations }
    return data          # ä¿å­˜ç›¸å…³å‚æ•°
</code></pre>
<h2 id="5-å®Œæ•´ä»£ç ">5ã€å®Œæ•´ä»£ç </h2>
<pre><code>import numpy as np
import h5py
import matplotlib.pyplot as plt

def load_dataset():
    train_dataset = h5py.File('datasets/train_catvnoncat.h5', &quot;r&quot;)
    train_set_x_orig = np.array(train_dataset[&quot;train_set_x&quot;][:]) # your train set features
    train_set_y_orig = np.array(train_dataset[&quot;train_set_y&quot;][:]) # your train set labels

    test_dataset = h5py.File('datasets/test_catvnoncat.h5', &quot;r&quot;)
    test_set_x_orig = np.array(test_dataset[&quot;test_set_x&quot;][:]) # your test set features
    test_set_y_orig = np.array(test_dataset[&quot;test_set_y&quot;][:]) # your test set labels

    classes = np.array(test_dataset[&quot;list_classes&quot;][:]) # the list of classes

    train_set_y_orig = train_set_y_orig.reshape((1, train_set_y_orig.shape[0]))
    test_set_y_orig = test_set_y_orig.reshape((1, test_set_y_orig.shape[0]))

    return train_set_x_orig, train_set_y_orig, test_set_x_orig, test_set_y_orig, classes


train_set_x_orig, train_set_y, test_set_x_orig, test_set_y, classes = load_dataset()
# index = 88
# img = train_set_x_orig[index]
# print(img)
# plt.imshow(img)
# plt.show()

number_train = train_set_y.shape[1]
number_test = test_set_y.shape[1]
number_px = train_set_x_orig.shape[1]

print(&quot;è®­ç»ƒé›†å›¾ç‰‡çš„æ•°é‡:&quot;, number_train)
print(&quot;æµ‹è¯•é›†å›¾ç‰‡çš„æ•°é‡:&quot;, number_test)
print(&quot;æ¯å¼ å›¾ç‰‡çš„å¤§å°:&quot;, number_px, &quot;*&quot;, number_px)
print(&quot;è®­ç»ƒé›†æ•°æ®çš„ç»´æ•°:&quot;, train_set_x_orig.shape)
print(&quot;è®­ç»ƒé›†æ ‡ç­¾çš„ç»´æ•°:&quot;, train_set_y.shape)
print(&quot;æµ‹è¯•é›†æ•°æ®çš„ç»´æ•°:&quot;, test_set_x_orig.shape)
print(&quot;æµ‹è¯•é›†æ ‡ç­¾çš„ç»´æ•°:&quot;, test_set_y.shape)

train_x_con = train_set_x_orig.reshape(train_set_x_orig.shape[0], -1).T
test_x_con = test_set_x_orig.reshape(test_set_x_orig.shape[0], -1).T
print(&quot;é™ç»´åè®­ç»ƒé›†æ•°æ®çš„ç»´æ•°:&quot;, train_x_con.shape)
print(&quot;é™ç»´åæµ‹è¯•é›†æ•°æ®çš„ç»´æ•°:&quot;, test_x_con.shape)

train_set_x = train_x_con /255
test_set_x = test_x_con /255


def sigmoid(z):
    s = 1 / (1 + np.exp(-z))
    return s


def init_variable(dim):
    w = np.zeros((dim, 1))
    b = 0
    return w, b


def propagate(w, b, X, Y):
    m = X.shape[1]

    # å‰å‘ä¼ æ’­
    A = sigmoid(np.dot(w.T, X) + b)
    cost = (-1 / m) * np.sum(Y * np.log(A) + (1 - Y) * np.log(1 - A))

    # åå‘ä¼ æ’­
    dw = (1 / m) * np.dot(X, (A - Y).T)
    db = (1 / m) * np.sum(A - Y)

    reci = {
        &quot;dw&quot;: dw,
        &quot;db&quot;: db
    }

    return  reci, cost


def optimize(w, b, X, Y, num_iterations, learning_rate, print_cost= False):
    costs = []
    for i in range(num_iterations):
        reci, cost = propagate(w, b, X, Y)
        dw = reci[&quot;dw&quot;]
        db = reci[&quot;db&quot;]
        w = w - learning_rate * dw
        b = b - learning_rate * db
        if i % 100 == 0:
            costs.append(cost)
        if (print_cost) and (i % 100 == 0):
            print(&quot;è¿­ä»£æ¬¡æ•°:%d , è¯¯å·®å€¼: %f&quot;  %(i, cost))

    params = {
        &quot;w&quot;: w,
        &quot;b&quot;: b
    }
    return params, costs


def predict(X, Y, w, b):
    m = X.shape[1]
    Y_prediction = np.zeros((1, m))
    w = w.reshape(X.shape[0], 1)

    A = sigmoid(np.dot(w.T, X) + b)

    for i in range(m):
        Y_prediction[0, i] = 1 if A[0, i] &gt; 0.5 else 0

    return Y_prediction


def main(X_train, Y_train, X_test, Y_test, num_iterations, learning_rate, print_cost):
    w, b = init_variable(X_train.shape[0])
    params, costs = optimize(w, b, X_train, Y_train, num_iterations, learning_rate, print_cost)
    w, b = params[&quot;w&quot;], params[&quot;b&quot;]

    Y_train_prediction = predict(X_train, Y_train, w, b)
    Y_test_prediction = predict(X_test, Y_test, w, b)

    print(&quot;è®­ç»ƒé›†å‡†ç¡®åº¦:&quot;, 100 - np.mean(np.abs(Y_train - Y_train_prediction)) * 100, &quot;%&quot;)
    print(&quot;æµ‹è¯•é›†å‡†ç¡®åº¦:&quot;, 100 - np.mean(np.abs(Y_test - Y_test_prediction)) * 100, &quot;%&quot;)

    data = {
            &quot;costs&quot; : costs,
            &quot;Y_prediction_test&quot; : Y_test_prediction,
            &quot;Y_prediciton_train&quot; : Y_train_prediction,
            &quot;w&quot; : w,
            &quot;b&quot; : b,
            &quot;learning_rate&quot; : learning_rate,
            &quot;num_iterations&quot; : num_iterations }
    return data

if __name__ == &quot;__main__&quot;:
    data = main(train_set_x, train_set_y, test_set_x, test_set_y, num_iterations=2000, learning_rate=0.005, print_cost=True)
</code></pre>
<h2 id="è¿è¡Œç»“æœ">è¿è¡Œç»“æœï¼š</h2>
<pre><code class="language-python">è®­ç»ƒé›†å›¾ç‰‡çš„æ•°é‡: 209
æµ‹è¯•é›†å›¾ç‰‡çš„æ•°é‡: 50
æ¯å¼ å›¾ç‰‡çš„å¤§å°: 64 * 64
è®­ç»ƒé›†æ•°æ®çš„ç»´æ•°: (209, 64, 64, 3)
è®­ç»ƒé›†æ ‡ç­¾çš„ç»´æ•°: (1, 209)
æµ‹è¯•é›†æ•°æ®çš„ç»´æ•°: (50, 64, 64, 3)
æµ‹è¯•é›†æ ‡ç­¾çš„ç»´æ•°: (1, 50)
é™ç»´åè®­ç»ƒé›†æ•°æ®çš„ç»´æ•°: (12288, 209)
é™ç»´åæµ‹è¯•é›†æ•°æ®çš„ç»´æ•°: (12288, 50)
è¿­ä»£æ¬¡æ•°:0 , è¯¯å·®å€¼: 0.693147
è¿­ä»£æ¬¡æ•°:100 , è¯¯å·®å€¼: 0.584508
è¿­ä»£æ¬¡æ•°:200 , è¯¯å·®å€¼: 0.466949
è¿­ä»£æ¬¡æ•°:300 , è¯¯å·®å€¼: 0.376007
è¿­ä»£æ¬¡æ•°:400 , è¯¯å·®å€¼: 0.331463
è¿­ä»£æ¬¡æ•°:500 , è¯¯å·®å€¼: 0.303273
è¿­ä»£æ¬¡æ•°:600 , è¯¯å·®å€¼: 0.279880
è¿­ä»£æ¬¡æ•°:700 , è¯¯å·®å€¼: 0.260042
è¿­ä»£æ¬¡æ•°:800 , è¯¯å·®å€¼: 0.242941
è¿­ä»£æ¬¡æ•°:900 , è¯¯å·®å€¼: 0.228004
è¿­ä»£æ¬¡æ•°:1000 , è¯¯å·®å€¼: 0.214820
è¿­ä»£æ¬¡æ•°:1100 , è¯¯å·®å€¼: 0.203078
è¿­ä»£æ¬¡æ•°:1200 , è¯¯å·®å€¼: 0.192544
è¿­ä»£æ¬¡æ•°:1300 , è¯¯å·®å€¼: 0.183033
è¿­ä»£æ¬¡æ•°:1400 , è¯¯å·®å€¼: 0.174399
è¿­ä»£æ¬¡æ•°:1500 , è¯¯å·®å€¼: 0.166521
è¿­ä»£æ¬¡æ•°:1600 , è¯¯å·®å€¼: 0.159305
è¿­ä»£æ¬¡æ•°:1700 , è¯¯å·®å€¼: 0.152667
è¿­ä»£æ¬¡æ•°:1800 , è¯¯å·®å€¼: 0.146542
è¿­ä»£æ¬¡æ•°:1900 , è¯¯å·®å€¼: 0.140872
è®­ç»ƒé›†å‡†ç¡®åº¦: 99.04306220095694 %
æµ‹è¯•é›†å‡†ç¡®åº¦: 70.0 %
</code></pre>
<p>6ã€<br>
<code>learning_rate</code>æ˜¯æˆ‘ä»¬çš„å­¦ä¹ ç‡Î±ï¼Œé€‰æ‹©å­¦ä¹ ç‡ä¹Ÿæ˜¯å¾ˆé‡è¦çš„ï¼Œå®ƒæ˜¯æˆ‘ä»¬æ›´æ–°å˜é‡çš„é€Ÿç‡ï¼Œå¦‚æœå¤ªå¤§ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¼šé”™è¿‡æœ€ä¼˜è§£ï¼Œå¤ªå°çš„è¯åˆéœ€è¦å¢åŠ è¿­ä»£æ¬¡æ•°ï¼Œä½†æ˜¯ç›®å‰æˆ‘è¿˜ä¸çŸ¥é“åˆç†çš„èŒƒå›´æ˜¯ä»€ä¹ˆï¼Œä»£ç ä¸­è®¾ç½®çš„<code>0.005</code>æ˜¯å‚è€ƒæ–‡ç« ä¸­ç»™çš„ï¼Œæˆ‘è‡ªå·±å°è¯•è®¾ç½®ä¸º0.5å‘ç°ä¼šå‡ºé”™ï¼Œè¿™æ–¹é¢åç»­ä¼šç»§ç»­å­¦ä¹ ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ç”»å›¾æ¥çœ‹ä¸€ä¸‹æœ¬æ¬¡çš„æˆæœ¬æ›²çº¿ï¼š</p>
<pre><code class="language-python"># ç”»å›¾
costs = data['costs']
plt.plot(costs)
plt.ylabel('cost')
plt.xlabel('iterations (per hundreds)')
plt.title(&quot;Learning rate =&quot; + str(data[&quot;learning_rate&quot;]))
plt.show()
</code></pre>
<p><img src="https://raw.githubusercontent.com/Tudouvvv/Pic_path/master/2018-10-19-%E6%88%90%E6%9C%AC%E6%9B%B2%E7%BA%BFpng.png" alt=""><br>
å¯ä»¥çœ‹åˆ°ä¼´éšç€è¿­ä»£æ¬¡æ•°çš„å¢åŠ ï¼Œæˆæœ¬å€¼åœ¨ä¸‹é™ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥è‡ªå·±æ‰¾ä¸€ä¸‹å›¾ç‰‡ï¼Œè®¾ç½®ä¸º64*64çš„ï¼Œæ¥æµ‹è¯•ä¸€ä¸‹è¿™ä¸ªçš„å‡†ç¡®åº¦ï¼š<br>
<img src="https://raw.githubusercontent.com/Tudouvvv/Pic_path/master/2018-10-19-8_test.png" alt=""><br>
æ‰¾äº†8å¼ å›¾ç‰‡ï¼Œåˆ†åˆ«ç¼–å·1--8ï¼Œé€šè¿‡ä¸Šé¢çš„predictå‡½æ•°æ¥è¿›è¡Œé¢„æµ‹ç»“æœï¼š</p>
<pre><code class="language-python">import matplotlib.image as mpimg  # åœ¨å¼€å§‹å¤„å¯¼å…¥ï¼Œä¸»è¦ä½œç”¨æ˜¯è¯»å–å›¾ç‰‡ä¿¡æ¯
    
    img1 = mpimg.imread(&quot;test/1.jpg&quot;).reshape(-1, 1)
    img2 = mpimg.imread(&quot;test/2.jpg&quot;).reshape(-1, 1)
    img3 = mpimg.imread(&quot;test/3.jpg&quot;).reshape(-1, 1)
    img4 = mpimg.imread(&quot;test/4.jpg&quot;).reshape(-1, 1)
    img5 = mpimg.imread(&quot;test/5.jpg&quot;).reshape(-1, 1)
    img6 = mpimg.imread(&quot;test/6.png&quot;).reshape(-1, 1)
    img7 = mpimg.imread(&quot;test/7.png&quot;).reshape(-1, 1)
    img8 = mpimg.imread(&quot;test/8.jpg&quot;).reshape(-1, 1)

    img = np.hstack((img1, img2, img3, img4, img5, img6, img7, img8))   # np.hstack()ä¸»è¦è¿›è¡Œæ‹¼æ¥çŸ©é˜µçš„ä½œç”¨

    w = data[&quot;w&quot;]
    b = data[&quot;b&quot;]

    Y_prediction = predict(img, w, b)
    Y_prediction = np.squeeze(Y_prediction)     # np.squeeze()ä¸»è¦è¿›è¡ŒçŸ©é˜µé™ç»´çš„ä½œç”¨
    for i in range(len(Y_prediction)):
        if Y_prediction[i] == 1:
            print(&quot;ç¬¬%iå¼ å›¾ç‰‡ä¸­æœ‰çŒ«&quot; %(i+1))
        else:
            print(&quot;ç¬¬%iå¼ å›¾ç‰‡ä¸­æ²¡æœ‰çŒ«&quot; %(i+1))
</code></pre>
<p>é¢„æµ‹ç»“æœï¼š</p>
<pre><code class="language-python">ç¬¬1å¼ å›¾ç‰‡ä¸­æœ‰çŒ«
ç¬¬2å¼ å›¾ç‰‡ä¸­æœ‰çŒ«
ç¬¬3å¼ å›¾ç‰‡ä¸­æœ‰çŒ«
ç¬¬4å¼ å›¾ç‰‡ä¸­æœ‰çŒ«
ç¬¬5å¼ å›¾ç‰‡ä¸­æ²¡æœ‰çŒ«
ç¬¬6å¼ å›¾ç‰‡ä¸­æœ‰çŒ«
ç¬¬7å¼ å›¾ç‰‡ä¸­æ²¡æœ‰çŒ«
ç¬¬8å¼ å›¾ç‰‡ä¸­æ²¡æœ‰çŒ«
</code></pre>
<center>ä»¥ä¸Š!</center> </p>
                      </div>
                  </div>

                  <div class="row">
                      <div class="col-md-12 animate-box">
                          
                              <div class="next-post">
                                  <div class="next">ä¸‹ä¸€ç¯‡</div>
                                  <a href="https://tudouvvv.github.io//post/Pythonæ•°æ®åº“å­¦ä¹ ">
                                      <h3 class="post-title">
                                          Pythonæ•°æ®åº“å­¦ä¹ 
                                      </h3>
                                  </a>
                              </div>
                          
                      </div>
                  </div>

                  <div class="row">
                      <div class="col-md-12 animate-box">
                          
                      </div>
                  </div>
              </div>

          </article>
      </div>
  </div>

    
<footer id="fh5co-footer">
  <p>Powered by <a href="https://github.com/tudouvvv" target="_blank">Tudouvvv</a></p>
</footer>


    
<!-- jQuery -->
<script src="https://tudouvvv.github.io//media/scripts/_vendors/jquery.min.js"></script>
<!-- jQuery Easing -->
<script src="https://tudouvvv.github.io//media/scripts/_vendors/jquery.easing.1.3.js"></script>
<!-- Bootstrap -->
<script src="https://tudouvvv.github.io//media/scripts/_vendors/bootstrap.min.js"></script>
<!-- Waypoints -->
<script src="https://tudouvvv.github.io//media/scripts/_vendors/jquery.waypoints.min.js"></script>
<!-- Main JS -->
<script src="https://tudouvvv.github.io//media/scripts/_vendors/main.js"></script>
<!-- Md5 Min JS -->
<script src="https://tudouvvv.github.io//media/scripts/_vendors/md5.min.js"></script>

<script type="application/javascript">
    hljs.initHighlightingOnLoad();
</script>




  </body>
</html>
